# CVE-2018-20343
This is a PoC for CVE-2018-20343.
The generated .map file triggers a buffer overflow and overwrites the stack as shown below:

<figure>
  <img src="https://github.com/Alexandre-Bartel/CVE-2018-20343/blob/master/wd_stack.png" width="400">
  <figcaption>Open Watcom under DosBox 0.74-2: the analyst controls the stack</figcaption>
<figure>

<figure>
  <img src="https://github.com/Alexandre-Bartel/CVE-2018-20343/blob/master/freedos_EIP.png" width="400">
  <figcaption>Under FreeDos 1.2: the analyst controls EIP</figcaption>
<figure>

The PoC for this vulnerability has been tested using the following enviroment:

* Ken Silverman's [Build engine](http://www.advsys.net/ken/buildsrc/default.htm) [KENBUILD.ZIP](http://www.advsys.net/ken/buildsrc/kenbuild.zip) (sha256sum 704a5eee1b722ed5f452d3fb1aff197f0d201ff9737839846268c6b1e07f8e1f)
* target binary GAME.EXE (sha256sum 120acdf872af56ac65982a0c21e3aa2fdd06b70bd6203869ba777ce3e6daa5e4) compiled with the [Open Watcom compiler 1.9](http://www.openwatcom.org/)
* [DOSBox](https://www.dosbox.com/) 0.74-2 || [FreeDOS](https://www.freedos.org/) 1.2 under [QEMU](https://www.qemu.org/).

